{
    "comments": [
        {
            "author": "Nicholas DiPiazza",
            "body": "This was an issue of mixing in 1.4 with 1.4.5 jars",
            "date": "2008-10-08T14:53:36.022+0000",
            "id": 0
        }
    ],
    "component": "jackrabbit-core",
    "description": "When I store versionable files, I get problems retrieving the jcr:data from a custom node type.\n\nI am storing a node type:\n\nxrc:learningContent\n        pd: xrc:Keywords\n        pd: xrc:MimeType\n        pd: jcr:mixinTypes\n        pd: xrc:Description\n        pd: xrc:Language\n        pd: xrc:Creator\n        pd: jcr:created\n        pd: xrc:Title\n        pd: jcr:primaryType\nExtends: nt:resource\n        pd: jcr:uuid\n        pd: jcr:mixinTypes\n        pd: jcr:data\n        pd: jcr:encoding\n        pd: jcr:mimeType\n        pd: jcr:lastModified\n        pd: jcr:primaryType\n\nSo I commit the changes, then later pull up the version and get it's frozenNode.\n\nNode frozenNode = v.getNode(JcrConstants.JCR_FROZENNODE);\n\nAnd then I return all of the properties contained within:\n\nPropertyIterator pi = frozenNode.getProperties();\n                while (pi.hasNext()) {\n                    System.out.println(pi.nextProperty().getName());\n}\n\n\nAll that are returned are:\n\njcr:frozenUuid\njcr:uuid\njcr:frozenPrimaryType\njcr:frozenMixinTypes\njcr:primaryType\n\nHere is the frozen node type:\n\nnt:frozenNode\n        pd: *\n        pd: *\n        pd: jcr:frozenUuid\n        pd: jcr:uuid\n        pd: jcr:mixinTypes\n        pd: jcr:frozenPrimaryType\n        pd: jcr:frozenMixinTypes\n        pd: jcr:primaryType\n\n\n\nSo basically it would seem that the recursive copy inside the InternalFrozenNodeImpl is not working. But it seems that is not the case from the code trace I did. Add this to line 368 of InternalFrozenNodeImpl.java\n\nSystem.out.println(\"New node created. Props: \");\n        try {\n            PropertyState [] ps = node.getProperties();\n            for (PropertyState p : ps) {\n                System.out.println(p.getName());\n                System.out.println(p.toString());\n            }\n            NodeStateEx [] ns = node.getChildNodes();\n            for (NodeStateEx n : ns) {\n                System.out.println(n.getName());\n                System.out.println(n.toString());\n            }\n        } catch (ItemStateException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n\n\nAnd you will get the result:\n\n\nNew node created. Props:\n{http://www.jcp.org/jcr/1.0}uuid\norg.apache.jackrabbit.core.state.PropertyState@10dd791\n{http://www.jcp.org/jcr/1.0}frozenPrimaryType\norg.apache.jackrabbit.core.state.PropertyState@1c38291\n{http://www.jcp.org/jcr/1.0}frozenMixinTypes\norg.apache.jackrabbit.core.state.PropertyState@b12fbb\n{http://www.jcp.org/jcr/1.0}baseVersion\norg.apache.jackrabbit.core.state.PropertyState@b4d4b6\n{http://www.jcp.org/jcr/1.0}primaryType\norg.apache.jackrabbit.core.state.PropertyState@1f9045f\n{http://www.jcp.org/jcr/1.0}isCheckedOut\norg.apache.jackrabbit.core.state.PropertyState@18e16b5\n{http://www.jcp.org/jcr/1.0}frozenUuid\norg.apache.jackrabbit.core.state.PropertyState@174cb00\n{http://www.jcp.org/jcr/1.0}predecessors\norg.apache.jackrabbit.core.state.PropertyState@bb7c1b\n{http://www.jcp.org/jcr/1.0}data\norg.apache.jackrabbit.core.state.PropertyState@d10133\n{http://www.jcp.org/jcr/1.0}versionHistory\norg.apache.jackrabbit.core.state.PropertyState@1a5f001\n{http://www.jcp.org/jcr/1.0}encoding\norg.apache.jackrabbit.core.state.PropertyState@12fe3ef\n{http://www.jcp.org/jcr/1.0}mimeType\norg.apache.jackrabbit.core.state.PropertyState@11d92c8\n{http://www.jcp.org/jcr/1.0}lastModified\norg.apache.jackrabbit.core.state.PropertyState@8fb83a\nNew node created. Props:\n{http://www.xerceo.com/learn/jcr-1.0}Keywords\norg.apache.jackrabbit.core.state.PropertyState@18808f3\n{http://www.jcp.org/jcr/1.0}uuid\norg.apache.jackrabbit.core.state.PropertyState@397a4\n{http://www.jcp.org/jcr/1.0}frozenPrimaryType\norg.apache.jackrabbit.core.state.PropertyState@1d88ffd\n{http://www.xerceo.com/learn/jcr-1.0}Creator\norg.apache.jackrabbit.core.state.PropertyState@d5625b\n{http://www.xerceo.com/learn/jcr-1.0}Language\norg.apache.jackrabbit.core.state.PropertyState@12c70e6\n{http://www.xerceo.com/learn/jcr-1.0}Title\norg.apache.jackrabbit.core.state.PropertyState@a836b3\n{http://www.jcp.org/jcr/1.0}frozenMixinTypes\norg.apache.jackrabbit.core.state.PropertyState@19f273c\n{http://www.jcp.org/jcr/1.0}primaryType\norg.apache.jackrabbit.core.state.PropertyState@1c8e97d\n{http://www.jcp.org/jcr/1.0}frozenUuid\norg.apache.jackrabbit.core.state.PropertyState@15915a3\n{http://www.jcp.org/jcr/1.0}predecessors\norg.apache.jackrabbit.core.state.PropertyState@19ba907\n{http://www.xerceo.com/learn/jcr-1.0}MimeType\norg.apache.jackrabbit.core.state.PropertyState@763ca1\n{http://www.xerceo.com/learn/jcr-1.0}Description\norg.apache.jackrabbit.core.state.PropertyState@8687e8\n{http://www.jcp.org/jcr/1.0}versionHistory\norg.apache.jackrabbit.core.state.PropertyState@44ca0f\n{http://www.jcp.org/jcr/1.0}content\norg.apache.jackrabbit.core.version.NodeStateEx@2da721\n\nSo the new Node definately has these new properties.\n\nDo I have to somehow extend my frozenNode to work with this? Can anyone help me?",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "JCR-1792",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "Major",
    "product": "JACKRABBIT",
    "project": "JACKRABBIT",
    "summary": "jcr:frozenUuid does not contain jcr:content",
    "systemSpecification": true,
    "version": "core 1.4.5"
}