{
    "comments": [
        {
            "author": "Micah Whitacre",
            "body": "Zip file contains a basic implementation of a PrincipalProvider, a repository.xml file configured to use the PrincipalProvider, and a simple test case that when run generates the previously mentioned stack trace.",
            "date": "2008-06-05T20:09:02.854+0000",
            "id": 0
        },
        {
            "author": "Micah Whitacre",
            "body": "I don't have a patch but implementing my own LoginModule I did find that I needed to do two things to get this exception to go away:\n\n1. My custom login module needed to implement public String getPrincipalProvider() and public void setPrincipalProvider(String).\n2. The configuration in the repository.xml file needs to be for <param name=\"principalProvider\" value=\"...\"/>.  \n\nTherefore I think the LoginModuleConfig.PARAM_PRINCIPAL_PROVIDER_CLASS contant needs to be changed to equal \"principalProvider\" instead of being \"principalprovider\".",
            "date": "2008-06-09T19:59:04.461+0000",
            "id": 1
        },
        {
            "author": "Micah Whitacre",
            "body": "Here is a quick and dirty patch that adds the needed methods to AbstractLoginModule as well as modifying the LoginModuleConfig constant to be correct.",
            "date": "2008-06-09T21:46:06.378+0000",
            "id": 2
        },
        {
            "author": "angela",
            "body": "the 283 security section has undergone major changes.\ni will take care of this issue once the jackrabbit impl is aligned with the latest version.",
            "date": "2008-06-10T06:48:39.932+0000",
            "id": 3
        }
    ],
    "component": "jackrabbit-core, JCR 2.0, security",
    "description": "When configuring a custom PrincipalProvider for the SimpleLoginModule or DefaultLoginModule, inside of a repository.xml file with configuration such as the following:\n\n    <Security appName=\"Jackrabbit\">\n        <AccessManager\n            class=\"org.apache.jackrabbit.core.security.DefaultAccessManager\">\n        </AccessManager>\n        <LoginModule\n            class=\"org.apache.jackrabbit.core.security.authentication.DefaultLoginModule\">\n            <param name=\"principalprovider\" value=\"com.foo.jcr.BasicPrincipalProvider\"/>\n        </LoginModule>\n      <SecurityManager class=\"org.apache.jackrabbit.core.DefaultSecurityManager\">         \n      </SecurityManager>    \n    </Security>\n\nAnd that yields the following stacktrace:\n\njavax.jcr.LoginException: org.apache.jackrabbit.core.security.authentication.DefaultLoginModule does not support 'principalprovider: org.apache.jackrabbit.core.security.authentication.DefaultLoginModule does not support 'principalprovider: org.apache.jackrabbit.core.security.authentication.DefaultLoginModule does not support 'principalprovider\n\tat org.apache.jackrabbit.core.RepositoryImpl.login(RepositoryImpl.java:1353)\n\tat org.apache.jackrabbit.commons.AbstractRepository.login(AbstractRepository.java:53)\n\tat com.foo.jcr.PrincipalProviderTest.testPrincipalProvider(PrincipalProviderTest.java:24)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.junit.internal.runners.TestMethod.invoke(TestMethod.java:59)\n\tat org.junit.internal.runners.MethodRoadie.runTestMethod(MethodRoadie.java:98)\n\tat org.junit.internal.runners.MethodRoadie$2.run(MethodRoadie.java:79)\n\tat org.junit.internal.runners.MethodRoadie.runBeforesThenTestThenAfters(MethodRoadie.java:87)\n\tat org.junit.internal.runners.MethodRoadie.runTest(MethodRoadie.java:77)\n\tat org.junit.internal.runners.MethodRoadie.run(MethodRoadie.java:42)\n\tat org.junit.internal.runners.JUnit4ClassRunner.invokeTestMethod(JUnit4ClassRunner.java:88)\n\tat org.junit.internal.runners.JUnit4ClassRunner.runMethods(JUnit4ClassRunner.java:51)\n\tat org.junit.internal.runners.JUnit4ClassRunner$1.run(JUnit4ClassRunner.java:44)\n\tat org.junit.internal.runners.ClassRoadie.runUnprotected(ClassRoadie.java:27)\n\tat org.junit.internal.runners.ClassRoadie.runProtected(ClassRoadie.java:37)\n\tat org.junit.internal.runners.JUnit4ClassRunner.run(JUnit4ClassRunner.java:42)\n\tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:45)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)\nCaused by: javax.security.auth.login.LoginException: org.apache.jackrabbit.core.security.authentication.DefaultLoginModule does not support 'principalprovider\n\tat org.apache.jackrabbit.core.security.authentication.LocalAuthContext.login(LocalAuthContext.java:68)\n\tat org.apache.jackrabbit.core.RepositoryImpl.login(RepositoryImpl.java:1346)\n\t... 24 more\njavax.security.auth.login.LoginException: org.apache.jackrabbit.core.security.authentication.DefaultLoginModule does not support 'principalprovider\n\tat org.apache.jackrabbit.core.security.authentication.LocalAuthContext.login(LocalAuthContext.java:68)\n\tat org.apache.jackrabbit.core.RepositoryImpl.login(RepositoryImpl.java:1346)\n\tat org.apache.jackrabbit.commons.AbstractRepository.login(AbstractRepository.java:53)\n\tat com.foo.jcr.PrincipalProviderTest.testPrincipalProvider(PrincipalProviderTest.java:24)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.junit.internal.runners.TestMethod.invoke(TestMethod.java:59)\n\tat org.junit.internal.runners.MethodRoadie.runTestMethod(MethodRoadie.java:98)\n\tat org.junit.internal.runners.MethodRoadie$2.run(MethodRoadie.java:79)\n\tat org.junit.internal.runners.MethodRoadie.runBeforesThenTestThenAfters(MethodRoadie.java:87)\n\tat org.junit.internal.runners.MethodRoadie.runTest(MethodRoadie.java:77)\n\tat org.junit.internal.runners.MethodRoadie.run(MethodRoadie.java:42)\n\tat org.junit.internal.runners.JUnit4ClassRunner.invokeTestMethod(JUnit4ClassRunner.java:88)\n\tat org.junit.internal.runners.JUnit4ClassRunner.runMethods(JUnit4ClassRunner.java:51)\n\tat org.junit.internal.runners.JUnit4ClassRunner$1.run(JUnit4ClassRunner.java:44)\n\tat org.junit.internal.runners.ClassRoadie.runUnprotected(ClassRoadie.java:27)\n\tat org.junit.internal.runners.ClassRoadie.runProtected(ClassRoadie.java:37)\n\tat org.junit.internal.runners.JUnit4ClassRunner.run(JUnit4ClassRunner.java:42)\n\tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:45)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)",
    "hasPatch": true,
    "hasScreenshot": false,
    "id": "JCR-1641",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "Major",
    "product": "JACKRABBIT",
    "project": "JACKRABBIT",
    "summary": "DefaultLoginModule/SimpleLoginModule don't support custom PrincipalProvider",
    "systemSpecification": true,
    "version": "1.5"
}