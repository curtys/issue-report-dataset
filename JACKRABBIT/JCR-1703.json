{
    "comments": [
        {
            "author": "Stephane Landelle",
            "body": "Oups, I meant :\nif ((user == null || user.length() == 0) && (password == null || password.length() == 0)) {",
            "date": "2008-08-05T12:05:54.931+0000",
            "id": 0
        },
        {
            "author": "Thomas Mueller",
            "body": "If we do that, then an empty (\"\") user name and password are not supported any longer.\n\n> if no user/password are specified, they re retrieved as empty strings, not null\n\nI could not reproduce this. In my test case, both the user name and password are null:\n\n<DataStore class=\"org.apache.jackrabbit.core.data.db.DbDataStore\">\n    <param name=\"url\" value=\"jdbc:h2:~/db/datastore\"/>\n</DataStore>\n\nCould you provide a test case where user name and password are an empty string in this method, without setting the user name and password properties in the repository.xml / workspace.xml?\n",
            "date": "2008-08-18T17:22:26.668+0000",
            "id": 1
        },
        {
            "author": "Stephane Landelle",
            "body": "Hello,\n\nHere is my repository config :\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<Repository>\n    <FileSystem class=\"org.apache.jackrabbit.core.fs.db.OracleFileSystem\">\n        <param name=\"driver\" value=\"javax.naming.InitialContext\" />\n        <param name=\"url\" value=\"jcrDS\" />\n        <param name=\"schema\" value=\"oracle\" />\n        <param name=\"schemaObjectPrefix\" value=\"J_R_FS_\" />\n    </FileSystem>\n    <Security appName=\"Jackrabbit\">\n        <AccessManager\nclass=\"org.apache.jackrabbit.core.security.SimpleAccessManager\" />\n        <LoginModule\nclass=\"org.apache.jackrabbit.core.security.SimpleLoginModule\" />\n        <SecurityManager\nclass=\"org.apache.jackrabbit.core.security.simple.SimpleSecurityManager\"\nworkspaceName=\"security\">\n            <!-- <param name=\"config\" value=\"${rep.home}/security.xml\"/> -->\n        </SecurityManager>\n    </Security>\n    <Workspaces rootPath=\"${rep.home}/workspaces\" defaultWorkspace=\"default\"\n/>\n    <Workspace name=\"${wsp.name}\">\n        <FileSystem\nclass=\"org.apache.jackrabbit.core.fs.db.OracleFileSystem\">\n            <param name=\"driver\" value=\"javax.naming.InitialContext\" />\n            <param name=\"url\" value=\"jcrDS\" />\n            <param name=\"schema\" value=\"oracle\" />\n            <param name=\"schemaObjectPrefix\" value=\"J_FS_${wsp.name}_\" />\n        </FileSystem>\n        <PersistenceManager\nclass=\"org.apache.jackrabbit.core.persistence.db.OraclePersistenceManager\">\n            <param name=\"driver\" value=\"javax.naming.InitialContext\" />\n            <param name=\"url\" value=\"jcrDS\" />\n            <param name=\"schema\" value=\"oracle\" />\n            <param name=\"schemaObjectPrefix\" value=\"J_PM_${wsp.name}_\" />\n            <param name=\"externalBLOBs\" value=\"false\" />\n        </PersistenceManager>\n        <SearchIndex\nclass=\"org.apache.jackrabbit.core.query.lucene.SearchIndex\">\n            <param name=\"path\" value=\"${wsp.home}/index\" />\n            <param name=\"useCompoundFile\" value=\"true\" />\n            <param name=\"minMergeDocs\" value=\"100\" />\n            <param name=\"volatileIdleTime\" value=\"3\" />\n            <param name=\"maxMergeDocs\" value=\"100000\" />\n            <param name=\"mergeFactor\" value=\"10\" />\n            <param name=\"maxFieldLength\" value=\"10000\" />\n            <param name=\"bufferSize\" value=\"10\" />\n            <param name=\"cacheSize\" value=\"1000\" />\n            <param name=\"forceConsistencyCheck\" value=\"false\" />\n            <param name=\"autoRepair\" value=\"true\" />\n            <param name=\"analyzer\"\nvalue=\"org.apache.lucene.analysis.standard.StandardAnalyzer\" />\n            <param name=\"respectDocumentOrder\" value=\"true\" />\n            <param name=\"resultFetchSize\" value=\"2147483647\" />\n            <param name=\"extractorPoolSize\" value=\"0\" />\n            <param name=\"extractorTimeout\" value=\"100\" />\n            <param name=\"extractorBackLogSize\" value=\"100\" />\n            <param name=\"indexingConfiguration\"\nvalue=\"${rep.home}/indexing-configuration.xml\" />\n        </SearchIndex>\n    </Workspace>\n    <Versioning rootPath=\"${rep.home}/versions\">\n        <FileSystem\nclass=\"org.apache.jackrabbit.core.fs.db.OracleFileSystem\">\n            <param name=\"driver\" value=\"javax.naming.InitialContext\" />\n            <param name=\"url\" value=\"jcrDS\" />\n            <param name=\"schema\" value=\"oracle\" />\n            <param name=\"schemaObjectPrefix\" value=\"J_V_FS_\" />\n        </FileSystem>\n        <PersistenceManager\nclass=\"org.apache.jackrabbit.core.persistence.db.OraclePersistenceManager\">\n            <param name=\"driver\" value=\"javax.naming.InitialContext\" />\n            <param name=\"url\" value=\"jcrDS\" />\n            <param name=\"schema\" value=\"oracle\" />\n            <param name=\"schemaObjectPrefix\" value=\"J_V_PM_\" />\n            <param name=\"externalBLOBs\" value=\"false\" />\n        </PersistenceManager>\n    </Versioning>\n    <SearchIndex\nclass=\"org.apache.jackrabbit.core.query.lucene.SearchIndex\">\n        <param name=\"path\" value=\"${rep.home}/repository/index\" />\n        <param name=\"useCompoundFile\" value=\"true\" />\n        <param name=\"minMergeDocs\" value=\"100\" />\n        <param name=\"volatileIdleTime\" value=\"3\" />\n        <param name=\"maxMergeDocs\" value=\"100000\" />\n        <param name=\"mergeFactor\" value=\"10\" />\n        <param name=\"maxFieldLength\" value=\"10000\" />\n        <param name=\"bufferSize\" value=\"10\" />\n        <param name=\"cacheSize\" value=\"1000\" />\n        <param name=\"forceConsistencyCheck\" value=\"false\" />\n        <param name=\"autoRepair\" value=\"true\" />\n        <param name=\"analyzer\"\nvalue=\"org.apache.lucene.analysis.standard.StandardAnalyzer\" />\n        <param name=\"respectDocumentOrder\" value=\"true\" />\n        <param name=\"resultFetchSize\" value=\"2147483647\" />\n        <param name=\"extractorPoolSize\" value=\"0\" />\n        <param name=\"extractorTimeout\" value=\"100\" />\n        <param name=\"extractorBackLogSize\" value=\"100\" />\n        <param name=\"indexingConfiguration\"\nvalue=\"${rep.home}/indexing-configuration.xml\" />\n    </SearchIndex>\n    <Cluster id=\"node_webapp\" syncDelay=\"5\">\n        <Journal\nclass=\"org.apache.jackrabbit.core.journal.OracleDatabaseJournal\">\n            <param name=\"revision\" value=\"${rep.home}/revision\" />\n            <param name=\"driver\" value=\"javax.naming.InitialContext\" />\n            <param name=\"url\" value=\"jcrDS\" />\n            <param name=\"schema\" value=\"oracle\" />\n            <param name=\"schemaObjectPrefix\" value=\"J_C_\" />\n        </Journal>\n    </Cluster>\n</Repository>\n\nMy problem is actually with the\norg.apache.jackrabbit.core.persistence.db.OraclePersistenceManager, not the\nbundle one.\n\nI just saw a close ticket (JCR-1562) with similar problem. Would it be\npossible to apply the same kind of patch?\n\nSincerely,\n\nSt\u00e9phane\n\n\n2008/8/18 Thomas Mueller (JIRA) <jira@apache.org>\n\n",
            "date": "2008-08-19T17:58:45.081+0000",
            "id": 2
        },
        {
            "author": "Thomas Mueller",
            "body": "I think you are right. I propose the following change:\n\n===================================================================\n--- jackrabbit-core/src/main/java/org/apache/jackrabbit/core/fs/db/OracleFileSystem.java\t(revision 693399)\n+++ jackrabbit-core/src/main/java/org/apache/jackrabbit/core/fs/db/OracleFileSystem.java\t(working copy)\n@@ -100,8 +100,6 @@\n         schema = \"oracle\";\n         driver = \"oracle.jdbc.OracleDriver\";\n         schemaObjectPrefix = \"\";\n-        user = \"\";\n-        password = \"\";\n         initialized = false;\n     }\n \n",
            "date": "2008-09-09T08:44:24.461+0000",
            "id": 3
        },
        {
            "author": "Thomas Mueller",
            "body": "Committed in revision 697717 (trunk).\nI'm not sure if it should be applied to 1.4.6 as well.",
            "date": "2008-09-22T09:05:03.993+0000",
            "id": 4
        }
    ],
    "component": "jackrabbit-core",
    "description": "When org.apache.jackrabbit.core.persistence.bundle.util.ConnectionFactory tries to get a connection from a JNDI Datasource without login and pasword, if no user/password are specified, they re retrieved as empty strings, not null, so it tries to do a ds.getConnection(user, password), which fails. Please complete the test line 66 as :\nif ((user == null || user.length() > 0) && (password == null || password.length() > 0)) {\n\nSincerely,\n\nSt\u00e9phane Landelle",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "JCR-1703",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "Major",
    "product": "JACKRABBIT",
    "project": "JACKRABBIT",
    "summary": "Oracle JNDI DataSource support",
    "systemSpecification": true,
    "version": "core 1.4.5"
}