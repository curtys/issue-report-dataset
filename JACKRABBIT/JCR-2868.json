{
    "comments": [
        {
            "author": "Jukka Zitting",
            "body": "Thanks for the detailed report! I fixed this in revision 1066071 by making sure that the repository lock gets removed even if all else (including automatic shutdown that's attempted in this case) fails. Merged to the 2.2 branch in revision 1066072.",
            "date": "2011-02-01T15:41:03.903+0000",
            "id": 0
        }
    ],
    "component": "jackrabbit-core",
    "description": "I investigating the robustness of JackRabbit in the face of unexpected database errors, such as the database being unavailable. In my particular case, I am attempting to start a JackRabbit session using a TransientRepository while the database is not yet running. This correctly fails. However, if I attempt to create another session within the same thread after a short while, an exception occurs saying that the repository has already been locked. I would expect the repository folder not to be locked. Maybe the code meant to remove the .lock file was not triggered because of an uncaught exception.\n\nPlease see the attached files:\n-a test class to reproduce the problem\n-my repository.xml config\n-the log file quantel.txt with details about the stack trace.\n",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "JCR-2868",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "Major",
    "product": "JACKRABBIT",
    "project": "JACKRABBIT",
    "summary": "A failure to connect to a MySQL database when JackRabbit starts a session leaves a .lock file in the repository. Subsequent sessions cannot be created by the same thread.",
    "systemSpecification": true,
    "version": "2.2"
}