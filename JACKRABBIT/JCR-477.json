{
    "comments": [
        {
            "author": "Darren Hartford",
            "body": "Installation was based on: \nhttp://wiki.apache.org/jackrabbit/JackrabbitOnJBoss\n\n\nRuntime error details causing 500 error on DASL searches:\n===================\n10:37:42,569 INFO  [STDOUT] 12.07.2006 10:37:42 *INFO * RepositoryAccessServlet: Acquired repository via JNDI. (Reposito\nryAccessServlet.java, line 133)\n10:37:42,569 INFO  [STDOUT] 12.07.2006 10:37:42 *INFO * RepositoryAccessServlet: Jackrabbit v1.0-dev (RepositoryAccessSe\nrvlet.java, line 196)\n10:37:42,631 INFO  [jcr/local] Created session (org.apache.jackrabbit.core.XASessionImpl@566b3e)\n10:37:42,710 WARN  [JBossManagedConnectionPool] Destroying connection that could not be successfully matched: org.jboss.\nresource.connectionmanager.TxConnectionManager$TxConnectionEventListener@19ab9c5[state=NORMAL mc=org.apache.jackrabbit.j\nca.JCAManagedConnection@1ba1894 handles=0 lastUse=1152715062678 permit=false trackByTx=false mcp=org.jboss.resource.conn\nectionmanager.JBossManagedConnectionPool$OnePool@a3bb2e context=org.jboss.resource.connectionmanager.InternalManagedConn\nectionPool@155e508 xaResource=org.apache.jackrabbit.core.XASessionImpl@566b3e txSync=null]\n10:37:42,710 INFO  [jcr/local] Created session (org.apache.jackrabbit.core.XASessionImpl@dd23cf)\n10:37:42,710 INFO  [STDOUT] 12.07.2006 10:37:42 *INFO * JCRWebdavServer: login: User 'root' logged in. (JCRWebdavServer.\njava, line 177)\n10:37:42,850 INFO  [STDOUT] 12.07.2006 10:37:42 *INFO * JCRWebdavServer: Removed reference org.apache.jackrabbit.webdav.\nWebdavRequestImpl@1ff3fcf to session org.apache.jackrabbit.server.jcr.JCRWebdavServer$DavSessionImpl@1461c98 (JCRWebdavS\nerver.java, line 211)\n10:37:42,850 INFO  [STDOUT] 12.07.2006 10:37:42 *INFO * JCRWebdavServer: No more references present on webdav session ->\n clean up. (JCRWebdavServer.java, line 217)\n10:37:42,850 INFO  [STDOUT] 12.07.2006 10:37:42 *ERROR* [JCRWebdavServer]: Servlet.service() for servlet JCRWebdavServer\n threw exception (Log4JLogger.java, line 119)\njava.lang.IllegalStateException: Inactive logical session handle called\n        at org.apache.jackrabbit.jca.JCAManagedConnection.getSession(JCAManagedConnection.java:214)\n        at org.apache.jackrabbit.jca.JCASessionHandle.getSession(JCASessionHandle.java:84)\n        at org.apache.jackrabbit.jca.JCASessionHandle.getUserID(JCASessionHandle.java:98)\n        at org.apache.jackrabbit.server.jcr.JCRWebdavServer$SessionCache.getUserID(JCRWebdavServer.java:288)\n        at org.apache.jackrabbit.server.jcr.JCRWebdavServer$SessionCache.removeReference(JCRWebdavServer.java:222)\n        at org.apache.jackrabbit.server.jcr.JCRWebdavServer$SessionCache.access$400(JCRWebdavServer.java:139)\n        at org.apache.jackrabbit.server.jcr.JCRWebdavServer$DavSessionImpl.removeReference(JCRWebdavServer.java:132)\n        at org.apache.jackrabbit.server.jcr.JCRWebdavServer.releaseSession(JCRWebdavServer.java:93)\n        at org.apache.jackrabbit.server.AbstractWebdavServlet.service(AbstractWebdavServlet.java:203)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:175)\n        at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:74)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java\n:664)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at org.apache.tomcat.util.net.MasterSlaveWorkerThread.run(MasterSlaveWorkerThread.java:112)\n        at java.lang.Thread.run(Thread.java:595)\n=============================",
            "date": "2006-07-12T21:40:13.000+0000",
            "id": 0
        },
        {
            "author": "Edgar Poce",
            "body": "Hi Darren,\n\nIMO these are unrelated problems. \n\n1)\n13:20:48,857 INFO [STDOUT] log4j:ERROR A \"org.jboss.logging.util.OnlyOnceErrorHandler\" object is not assignable to a \"o rg.apache.log4j.spi.ErrorHandler\" variable. \n\nI think this is caused by a duplicated jar in your deployment, we should probably update the instructions at http://wiki.apache.org/jackrabbit/JackrabbitOnJBoss.\nA quick fix would be to remove log4j from the war and remove all the lines in the log4j.xml descriptor.\ne.g.\nWEB-INF/log4j.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!DOCTYPE log4j:configuration SYSTEM \"log4j.dtd\">\n<log4j:configuration xmlns:log4j=\"http://jakarta.apache.org/log4j/\">\n</log4j:configuration>\n\n2) \njava.lang.IllegalStateException: Inactive logical session handle called\n        at org.apache.jackrabbit.jca.JCAManagedConnection.getSession(JCAManagedConnection.java:214) \n\nThis problem is caused by a problem in a logging call which afaik shouldn't affect the servlet normal behaviour. it's fixed in rev. 421405\n\nbr,\nedgar",
            "date": "2006-07-13T03:49:19.000+0000",
            "id": 1
        },
        {
            "author": "Edgar Poce",
            "body": "changing priority since afaik it's only a logging problem",
            "date": "2006-07-13T03:53:03.000+0000",
            "id": 2
        },
        {
            "author": "Darren Hartford",
            "body": "confirmed, removing log4j.jar and modifying the log4j.xml file corrected the logging problem.  Also tested on 421603, and the described problem has disappeared.",
            "date": "2006-07-13T19:54:09.000+0000",
            "id": 3
        }
    ],
    "component": "jackrabbit-webdav",
    "description": "Tested two different installs of JBoss to verify problem is not related to a specific version. There is a problem with the jackrabbit-server.war when deploying on jboss.  Here are the details during deployment:\n\n=======================\n13:20:48,654 INFO  [TomcatDeployer] deploy, ctxPath=/jackrabbit-server, warUrl=.../deploy/jackrabbit-server.war/\n13:20:48,857 INFO  [STDOUT] log4j:ERROR A \"org.jboss.logging.util.OnlyOnceErrorHandler\" object is not assignable to a \"o rg.apache.log4j.spi.ErrorHandler\" variable.\n13:20:48,857 INFO  [STDOUT] log4j:ERROR The class \"org.apache.log4j.spi.ErrorHandler\" was loaded by\n13:20:48,857 INFO  [STDOUT] log4j:ERROR [WebappClassLoader\n  delegate: false\n  repositories:\n    /WEB-INF/classes/\n----------> Parent Classloader:\njava.net.FactoryURLClassLoader@19d277e\n] whereas object of type\n13:20:48,857 INFO  [STDOUT] log4j:ERROR \"org.jboss.logging.util.OnlyOnceErrorHandler\" was loaded by [org.jboss.system.se rver.NoAnnotationURLClassLoader@ab95e6].\n13:20:48,904 INFO  [STDOUT] log4j:ERROR Could not create an Appender. Reported error follows.\n13:20:48,904 INFO  [STDOUT] java.lang.ClassCastException: org.jboss.logging.appender.DailyRollingFileAppender\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.parseAppender(DOMConfigurator.java:165)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.findAppenderByName(DOMConfigurator.java:140)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.findAppenderByReference(DOMConfigurator.java:153\n)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.parseChildrenOfLoggerElement(DOMConfigurator.jav\na:415)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.parseRoot(DOMConfigurator.java:384)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.parse(DOMConfigurator.java:783)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.doConfigure(DOMConfigurator.java:666)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.doConfigure(DOMConfigurator.java:616)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.doConfigure(DOMConfigurator.java:602)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.helpers.OptionConverter.selectAndConfigure(OptionConverter.java:460)\n\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.LogManager.<clinit>(LogManager.java:113)\n13:20:48,904 INFO  [STDOUT]     at org.apache.log4j.xml.DOMConfigurator.configure(DOMConfigurator.java:543)\n13:20:48,904 INFO  [STDOUT]     at org.apache.jackrabbit.j2ee.LoggingServlet.configureXML(LoggingServlet.java:148)\n13:20:48,904 INFO  [STDOUT]     at org.apache.jackrabbit.j2ee.LoggingServlet.configure(LoggingServlet.java:115)\n13:20:48,904 INFO  [STDOUT]     at org.apache.jackrabbit.j2ee.LoggingServlet.init(LoggingServlet.java:86)\n======================\n \nUnlike most logging problems, this is having an impact during runtime - when trying to do DASL searches, will return a 500 error as the server was unable to log correctly.\n",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "JCR-477",
    "issuetypeClassified": "IMPROVEMENT",
    "issuetypeTracker": "BUG",
    "priority": "Trivial",
    "product": "JACKRABBIT",
    "project": "JACKRABBIT",
    "summary": "Deployment of webdav servlet on Jboss problem - logging",
    "systemSpecification": true,
    "version": ""
}