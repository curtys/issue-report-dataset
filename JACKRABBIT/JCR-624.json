{
    "comments": [
        {
            "author": "Marcel Reutegger",
            "body": "There was a missing call to Connection.close() in DerbyPersistenceManager.closeConnection().\n\nTo verify the fix I changed the test to loop 1000 times and it worked fine with as little as 10 meg of heap space.\n\nFixed in revision: 472045",
            "date": "2006-11-07T09:26:29.000+0000",
            "id": 0
        }
    ],
    "component": "",
    "description": "When repeat login and the logout many times, I encountered?OutOfMemoryError.\n\njavax.jcr.RepositoryException: Cannot instantiate persistence manager org.apache.jackrabbit.core.state.db.DerbyPersistenceManager: Java exception: 'Java heap space: java.lang.OutOfMemoryError'.: Java exception: 'Java heap space: java.lang.OutOfMemoryError'.\n\tat org.apache.jackrabbit.core.RepositoryImpl.createPersistenceManager(RepositoryImpl.java:1095)\n\tat org.apache.jackrabbit.core.RepositoryImpl.createVersionManager(RepositoryImpl.java:300)\n\tat org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:245)\n\tat org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:498)\n\tat org.apache.jackrabbit.core.TransientRepository$2.getRepository(TransientRepository.java:245)\n\tat org.apache.jackrabbit.core.TransientRepository.startRepository(TransientRepository.java:265)\n\tat org.apache.jackrabbit.core.TransientRepository.login(TransientRepository.java:333)\n\tat org.apache.jackrabbit.core.TransientRepository.login(TransientRepository.java:388)\n\tat Test.tryLoginAndLogout(Test.java:19)\n\tat Test.test1(Test.java:13)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat junit.framework.TestCase.runTest(TestCase.java:164)\n\tat junit.framework.TestCase.runBare(TestCase.java:130)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:120)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:230)\n\tat junit.framework.TestSuite.run(TestSuite.java:225)\n\tat org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:128)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)\nCaused by: SQL Exception: Java exception: 'Java heap space: java.lang.OutOfMemoryError'.\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement20.<init>(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement30.<init>(Unknown Source)\n\tat org.apache.derby.jdbc.Driver30.newEmbedPreparedStatement(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)\n\tat org.apache.jackrabbit.core.state.db.DatabasePersistenceManager.init(DatabasePersistenceManager.java:224)\n\tat org.apache.jackrabbit.core.RepositoryImpl.createPersistenceManager(RepositoryImpl.java:1091)\n\t... 27 more\njava.lang.OutOfMemoryError: Java heap space\n\n",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "JCR-624",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "Major",
    "product": "JACKRABBIT",
    "project": "JACKRABBIT",
    "summary": "OutOfMemoryError When repeat login and the logout many times",
    "systemSpecification": true,
    "version": "1.1"
}