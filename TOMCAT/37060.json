{
    "comments": [
        {
            "author": null,
            "body": "This is fixed now in SVN, and will appear in 5.5.13.",
            "date": "20051013T07:40:49",
            "id": 0
        }
    ],
    "component": "Connector:HTTP",
    "description": "When processing the page immedately after a successful container managed\nauthentication \"login\", the user-agent header is NULL. If I refresh the page or\ngo to other pages, the user-agent header is rendered properly.\n\nI have discussed this issue on the tomcat-user list for a number of days,\nthinking it must be something I had done wrong,\n\nHere are the steps:\n\n1) Request a protected page from my application.\n2) My CMA login page pops up, I enter userid and password.\n3) This POST is issued when I submit it:\n     POST /stars/auth/ j_username=user1&j_password=password1&login=Login\n4) HTTPLiveHeaders show all of the GET requests have a user-agent set\n   (I've included all 90 lines of them below).\n5) My page that appears has the following code:\n  <%\n  String _userAgent = request.getHeader(\"user-agent\");\n  out.write(\"USER-AGENT=\"+_userAgent);\n  ...\n6) And displays the following on my page:\n  USER-AGENT=null\n\nSTART OF HTTPLiveHeaders capture from the above POST:\n\nhttp://smartfish:8080/stars/auth/\n\nPOST /stars/auth/ HTTP/1.1\nHost: smartfish:8080\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12)\nGecko/20050915 Firefox/1.0.7\nAccept:\ntext/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nReferer: http://smartfish:8080/stars/HomePage.do\nCookie: JSESSIONID=3F6575A5957AC84BCC60FA878ED092A5.srv1; username=user1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 45\nj_username=user1&j_password=password1&login=Login\nHTTP/1.x 302 Moved Temporarily\nServer: Apache-Coyote/1.1\nLocation:\nhttp://smartfish:8080/stars/j_security_check?j_username=user1&j_password=fbce66f99c809283638f344ecb3d50674ea64189\nContent-Length: 0\nDate: Wed, 12 Oct 2005 16:33:46 GMT\n----------------------------------------------------------\nhttp://smartfish:8080/stars/j_security_check?j_username=user1&j_password=fbce66f99c809283638f344ecb3d50674ea64189\n\nGET\n/stars/j_security_check?j_username=user1&j_password=fbce66f99c809283638f344ecb3d50674ea64189\nHTTP/1.1\nHost: smartfish:8080\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12)\nGecko/20050915 Firefox/1.0.7\nAccept:\ntext/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nReferer: http://smartfish:8080/stars/HomePage.do\nCookie: JSESSIONID=3F6575A5957AC84BCC60FA878ED092A5.srv1; username=user1\n\nHTTP/1.x 302 Moved Temporarily\nServer: Apache-Coyote/1.1\nLocation: http://smartfish:8080/stars/HomePage.do\nContent-Length: 0\nDate: Wed, 12 Oct 2005 16:33:46 GMT\n----------------------------------------------------------\nhttp://smartfish:8080/stars/HomePage.do\n\nGET /stars/HomePage.do HTTP/1.1\nHost: smartfish:8080\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12)\nGecko/20050915 Firefox/1.0.7\nAccept:\ntext/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nReferer: http://smartfish:8080/stars/HomePage.do\nCookie: JSESSIONID=3F6575A5957AC84BCC60FA878ED092A5.srv1; username=user1\n\nHTTP/1.x 200 OK\nServer: Apache-Coyote/1.1\nPragma: No-cache\nCache-Control: no-cache,no-store,max-age=0\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nContent-Type: text/html;charset=UTF-8\nContent-Language: en\nContent-Length: 2989\nDate: Wed, 12 Oct 2005 16:33:52 GMT\n----------------------------------------------------------\nhttp://smartfish:8080/stars/WEB-INF/pages/%3C%=request.getContextPath()%%3E/images/cm_fill.gif\n\nGET /stars/WEB-INF/pages/%3C%=request.getContextPath()%%3E/images/cm_fill.gif\nHTTP/1.1\nHost: smartfish:8080\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.7.12)\nGecko/20050915 Firefox/1.0.7\nAccept: image/png,*/*;q=0.5\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nReferer: http://smartfish:8080/stars/HomePage.do\nCookie: JSESSIONID=3F6575A5957AC84BCC60FA878ED092A5.srv1; username=user1\n\nHTTP/1.x 400 Invalid URI\nServer: Apache-Coyote/1.1\nTransfer-Encoding: chunked\nDate: Wed, 12 Oct 2005 16:33:52 GMT\nConnection: close\n----------------------------------------------------------",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "37060",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "P3 normal",
    "product": "Tomcat 5",
    "project": "TOMCAT",
    "summary": "user-agent header is null immediately after CMA login",
    "systemSpecification": true,
    "version": "5.5.12"
}