{
    "comments": [
        {
            "author": null,
            "body": "There are two reasons the Actual LineInfo differs from the Expected LineInfo:\n\n1) When a TemplateText node spans more than one line in the JSP, Jasper SMAPs \nit as if all of the node's output source was generated by the first line of \nthe node's input source, and the other lines in the node's input source \ncontributed nothing.\n\n2) Jasper SMAPs each node independently of the others, and makes no attempt to \nconsolidate the resulting line section.  I'm not sure consolidation is \nactually required by the spec, but it reduces the size of the class files, so \nit's a good thing to do.\n\nI will attach a patch that fixes both of these.",
            "date": "20030804T06:43:38",
            "id": 0
        },
        {
            "author": null,
            "body": "Created attachment 7636\nProposed patch",
            "date": "20030804T06:44:49",
            "id": 1
        },
        {
            "author": null,
            "body": "I've applied the patch, thanks.",
            "date": "20030809T19:22:46",
            "id": 2
        }
    ],
    "component": "Jasper",
    "description": "I'm running Tomcat5.0.5 with JspServlet options \"mappedfile=true\" \nand \"dumpSmap=true\".  The SMAP file appears to be incorrect for HTML sections \nof the servlet.\n\nFor example, take the following trivial JSP (shown with line numbers):\n1 <head>\n2   <title>My Title</title>\n3 \n4 </head>\n\nThe corresponding lines in the generated servlet are:\n40      out.write(\"<head>\\n\");\n41      out.write(\"  \");\n42      out.write(\"<title>My Title\");\n43      out.write(\"</title>\\n\");\n44      out.write(\"\\n\");\n45            out.write(\"</head>\");\n\nActual LineInfo section of the SMAP file:\n*L\n1:40,2\n2:42\n2:43,2\n4:45\n\nExpected LineInfo section:\n*L\n1:40\n2:41,3\n3:44\n4:45",
    "hasPatch": true,
    "hasScreenshot": false,
    "id": "22006",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "P3 normal",
    "product": "Tomcat 5",
    "project": "TOMCAT",
    "summary": "Invalid SMAP line entries when running with mappedfile=true",
    "systemSpecification": true,
    "version": "5.0.5"
}