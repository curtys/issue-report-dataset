{
    "comments": [
        {
            "author": null,
            "body": "Hmm, I have add the missing className attribute to ReplicationValve. \nBut with the old admin webapp you can\u00b4t manage a cluster. ",
            "date": "20060104T19:18:53",
            "id": 0
        }
    ],
    "component": "Webapps:Administration",
    "description": "I am getting \"AttributeNotFoundException:  Cannot find attribute className\" when\nI try using the admin webapp to manage a clustered Tomcat (5.5.12). \n* This ONLY happens in clustered configuration.\n* The stack trace & server.xml are below.\n* When you launch into the admin page, you see only one context entry in Host\n(localhost) and the Realm entry below that is missing. However, the resources\ntree and users tree are normal.\n* All contexts appear in the manager webapp.\n* This also happened in 5.5.9, which I upgraded from to try to resolve this error.\n\nHere is my server.xml:\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n\n  <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" />\n  <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\" />\n  <Listener\nclassName=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" />\n  <Listener\nclassName=\"org.apache.catalina.storeconfig.StoreConfigLifecycleListener\"/>\n\n  <GlobalNamingResources>\n\n    <Resource name=\"UserDatabase\" auth=\"Container\"\n              type=\"org.apache.catalina.UserDatabase\"\n       description=\"User database that can be updated and saved\"\n           factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n          pathname=\"conf/tomcat-users.xml\" />\n\n  </GlobalNamingResources>\n\n  <Service name=\"Catalina\">\n\n    <Connector port=\"8080\" maxHttpHeaderSize=\"8192\"\n               maxThreads=\"150\" minSpareThreads=\"25\" maxSpareThreads=\"75\"\n               enableLookups=\"false\" redirectPort=\"8443\" acceptCount=\"100\"\n               connectionTimeout=\"20000\" disableUploadTimeout=\"true\" />\n \n    <Connector port=\"8009\"\n               enableLookups=\"false\" redirectPort=\"8443\" protocol=\"AJP/1.3\" />\n\n    <Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"erictest1\">\n\n      <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n             resourceName=\"UserDatabase\"/>\n\n      <Host name=\"localhost\" appBase=\"webapps\"\n       unpackWARs=\"true\" autoDeploy=\"true\"\n       xmlValidation=\"false\" xmlNamespaceAware=\"false\">\n\n            <DefaultContext>\n                <Valve\nclassName=\"org.apache.catalina.cluster.session.JvmRouteBinderValve\" />\n            </DefaultContext>\n\n            <Listener\nclassName=\"org.apache.catalina.cluster.session.JvmRouteSessionIDBinderLifecycleListener\"\n/>\n\n            <Cluster className=\"org.apache.catalina.cluster.tcp.SimpleTcpCluster\"\n                \nmanager.className=\"org.apache.catalina.cluster.session.DeltaManager\"\n                 expireSessionsOnShutdown=\"false\"\n                 useDirtyFlag=\"true\"\n                 notifyListenersOnReplication=\"true\">\n\n            <Membership\n                className=\"org.apache.catalina.cluster.mcast.McastService\"\n                name=\"erictest1\"\n                mcastAddr=\"228.0.0.1\"\n                mcastTTL=\"1\"\n                mcastPort=\"45564\"\n                mcastFrequency=\"500\"\n                mcastDropTime=\"3000\"/>\n\n            <Receiver\n                className=\"org.apache.catalina.cluster.tcp.ReplicationListener\"\n                tcpListenAddress=\"172.16.166.9\"\n                tcpListenPort=\"8001\"\n                tcpSelectorTimeout=\"100\"\n                tcpThreadCount=\"1\"/>\n\n            <Sender\n                className=\"org.apache.catalina.cluster.tcp.ReplicationTransmitter\"\n                replicationMode=\"pooled\"\n                ackTimeout=\"15000\"/>\n\n            <Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\n                  \nfilter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.png;.*\\.htm;.*\\.html;.*\\.css;.*\\.txt;\"\n                   primaryIndicator=\"true\"/>\n\n            <Deployer className=\"org.apache.catalina.cluster.deploy.FarmWarDeployer\"\n                      tempDir=\"deploy/temp/\"\n                      deployDir=\"webapps/\"\n                      watchDir=\"deploy/watch/\"\n                      watchEnabled=\"true\"/>\n        </Cluster>\n\n      </Host>\n\n    </Engine>\n\n  </Service>\n\n</Server>\n\n\nHere is the stack trace:\n\njavax.management.AttributeNotFoundException:  Cannot find attribute className\n        at\norg.apache.commons.modeler.BaseModelMBean.getAttribute(BaseModelMBean.java:306)\n        at\ncom.sun.jmx.mbeanserver.DynamicMetaDataImpl.getAttribute(DynamicMetaDataImpl.java:96)\n        at com.sun.jmx.mbeanserver.MetaDataImpl.getAttribute(MetaDataImpl.java:181)\n        at\ncom.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:638)\n        at\ncom.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:659)\n        at org.apache.webapp.admin.Lists.getValves(Lists.java:401)\n        at org.apache.webapp.admin.Lists.getValves(Lists.java:452)\n        at\norg.apache.webapp.admin.TomcatTreeBuilder.getValves(TomcatTreeBuilder.java:462)\n        at\norg.apache.webapp.admin.TomcatTreeBuilder.getContexts(TomcatTreeBuilder.java:310)\n        at\norg.apache.webapp.admin.TomcatTreeBuilder.getHosts(TomcatTreeBuilder.java:263)\n        at\norg.apache.webapp.admin.TomcatTreeBuilder.getServices(TomcatTreeBuilder.java:185)\n        at\norg.apache.webapp.admin.TomcatTreeBuilder.getServers(TomcatTreeBuilder.java:144)\n        at\norg.apache.webapp.admin.TomcatTreeBuilder.buildTree(TomcatTreeBuilder.java:101)\n        at org.apache.webapp.admin.SetUpTreeAction.execute(SetUpTreeAction.java:125)\n        at\norg.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:419)\n        at\norg.apache.struts.action.RequestProcessor.process(RequestProcessor.java:224)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1192)\n        at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:412)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.webapp.admin.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:123)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.cluster.tcp.ReplicationValve.invoke(ReplicationValve.java:145)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:856)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:744)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "37327",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "P2 normal",
    "product": "Tomcat 5",
    "project": "TOMCAT",
    "summary": "AttributeNotFoundException:  Cannot find attribute className",
    "systemSpecification": true,
    "version": "5.5.12"
}