{
    "comments": [
        {
            "author": null,
            "body": "This has already been fixed in CVS.\n\nHowever, I recommend using the data source realm instead, which is more robust\nand scalable (and setup is about the same).",
            "date": "20050325T01:08:52",
            "id": 0
        },
        {
            "author": null,
            "body": "Could you please  clarify th:\n1. What is the exact nature of the bug that has been fixed? Does it depend on the Oracle version or the \nOS?  Would moving the database to the same m/c where tomcat runs resolve the problem temporarily? \n2. When is the next stable version being released with this bug fixed?\n\n(In reply to comment #1)\n> This has already been fixed in CVS.\n> \n> However, I recommend using the data source realm instead, which is more robust\n> and scalable (and setup is about the same).",
            "date": "20050331T16:42:30",
            "id": 1
        }
    ],
    "component": "Catalina",
    "description": "Hi,\nProblem:\nWhile trying to login to our application using basic authentication, there is an\nsql exception being thrown. It starts working fine after tomcat is restarted.\nThis happens periodically. I am not sure about how often users logged in between\n periods of failure. It is possible that there was nobody using it for may be 15\ndays or so. It is critical that we fix this problem asap as the users are\nunhappy about failures this often. \nWhat's puzzling is that while performing basic authentication, the connection\nshould be closed after the browser is exited. So how can there be a connection\nreset problem!!!\n\nEnvironment:\n\nThe basic authentication has been configured using JDBC Realm entry in\ncontext.xml of the app. The backend database is Oracle 10G that is on a\ndifferent m/c from that where tomcat runs. \n\nSymptoms:\nThe server was restarted on Feb 25 and the log below shows socket exception on\nFeb 27. When there was an attempt to login on Mar 15, there was an\nauthentication error. But the socket exception doesn't show up in the logs\nanytime after Feb 27 although authentication failed once again on Mar 24. It is\nnot clear why there's only one socket exception but two authentication failures\nbetween restarts of tomcat.\n\nFeb 25, 2005 3:12:48 PM org.apache.catalina.startup.Catalina startINFO: Server\nstartup in 5250 msFeb 27, 2005 3:52:51 AM\norg.apache.tomcat.util.net.PoolTcpEndpoint processSocketSEVERE: Socket error\ncaused by remote host /60.21.206.10java.net.SocketException: Connection reset by\npeer        at java.net.PlainSocketImpl.socketSetOption(Native Method)        at\njava.net.PlainSocketImpl.setOption(PlainSocketImpl.java:240)        at\njava.net.Socket.setTcpNoDelay(Socket.java:771)        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.setSocketOptions(PoolTcpEndpoint.java:502)\n       at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:514)\n       at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n       at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n       at java.lang.Thread.run(Thread.java:552)Mar 15, 2005 9:41:50 AM\norg.apache.catalina.realm.JDBCRealm getPasswordSEVERE: Exception retrieving\npassword for \"evm\"java.sql.SQLException: Io exception: Connection reset       \nat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:124)\nat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:161)\n        at\noracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:273)\n        at\noracle.jdbc.driver.T4CPreparedStatement.execute_for_rows(T4CPreparedStatement.java:800)\n        at\noracle.jdbc.driver.OracleStatement.execute_maybe_describe(OracleStatement.java:912)\n        at\noracle.jdbc.driver.T4CPreparedStatement.execute_maybe_describe(T4CPreparedStatement.java:693)\n        at\noracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:983)\n        at\noracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:2884)\n        at\noracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:2925)\n        at org.apache.catalina.realm.JDBCRealm.getPassword(JDBCRealm.java:526)\n        at org.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:399)\n        at org.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:347)\nat org.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:347)       \nat\norg.apache.catalina.authenticator.BasicAuthenticator.authenticate(BasicAuthenticator.java:181)\n       at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:446)\n       at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)  \n     at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)  \n     at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n       at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)    \n     at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:825)     \n     at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:738)\n       at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:526)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)",
    "hasPatch": false,
    "hasScreenshot": false,
    "id": "34170",
    "issuetypeClassified": "BUG",
    "issuetypeTracker": "BUG",
    "priority": "P1 critical",
    "product": "Tomcat 5",
    "project": "TOMCAT",
    "summary": "Connection reset by peer exception while performing basic authentication (db connection pool not being used)",
    "systemSpecification": true,
    "version": "5.5.7"
}